<!doctype html>
<meta charset="utf-8">
<title>Vault · {{ cert_id }}</title>
<style>
  body{font-family:Arial,Helvetica,sans-serif;margin:24px;color:#111}
  .row{display:flex;gap:8px;align-items:center;margin:8px 0 16px}
  input,button{padding:6px 8px;border:1px solid #ddd;border-radius:6px}
  table{border-collapse:collapse;width:100%}
  th,td{border:1px solid #eee;padding:8px 10px;text-align:left;font-size:14px}
  th{background:#fafafa}
  .muted{color:#666;font-size:12px}
</style>

<h2>Vault · {{ cert_id }}</h2>
<div class="row">
  <form method="get" action="/vault">
    <input type="hidden" name="cert_id" value="{{ cert_id }}">
    <input name="q" value="{{ q or '' }}" placeholder="关键词（如：provider:tsa / status:ok / txid 前缀）">
    <button>搜索</button>
  </form>
  <a href="/api/receipts/export?cert_id={{ cert_id }}&q={{ q|urlencode }}"><button>导出 CSV</button></a>
  <a href="/verify_upgrade/{{ cert_id }}"><button>返回 Verify</button></a>
</div>

{% if rows and rows|length > 0 %}
<table>
  <tr>
    <th>cert_id</th><th>provider</th><th>status</th><th>txid</th><th>created_at</th>
  </tr>
  {% for r in rows %}
  <tr>
    <td>{{ cert_id }}</td>
    <td>{{ r.provider }}</td>
    <td>{{ r.status }}</td>
    <td>{{ r.txid }}</td>
    <td>{{ r.created_at }}</td>
  </tr>
  {% endfor %}
</table>
<p class="muted">共 {{ rows|length }} 条 · 与导出字段保持一致</p>
{% else %}
<p>暂无记录。可先回 <a href="/verify_upgrade/{{ cert_id }}">Verify</a> 写入示例数据再来。</p>
{% endif %}
